#include<stdio.h>
int main(){
 int n,i,j;
 int quantum,front=0,rear=0;
 printf("Enter the number of processes\n");
 scanf("%d",&n);

 int at[n],bt[n],rt[n],ct[n],tat[n],wt[n],visited[n],q[100];
 printf("Enter the arrival time for each processes\n");
 for(i=0;i<n;i++){
 printf("Process %d:",i+1);
 scanf("%d",&at[i]);	
}
printf("Enter the burst time for each processes\n");
for(i=0;i<n;i++){
 printf("Process %d:",i+1);
 scanf("%d",&bt[i]);
 rt[i]=bt[i];
 ct[i]=0;
}

int min_at=100;
for(i=0;i<n;i++){
 if(at[i]<min_at){
 min_at=at[i];
}
}
int curr;
curr=min_at;
printf("Enter the time quantum\n");
scanf("%d",&quantum);

int completed=0;
for(i=0;i<n;i++){
 visited[i]=0;
}

q[rear]=0;
rear++;
visited[0]=1;

float avg_tat=0,avg_wt=0;

while(completed<n){
  int process= q[front];
front++;
if(rt[process]>0){
 if(rt[process]<=quantum){
   curr+=rt[process];
   rt[process]=0;
   ct[process] = curr;
   tat[process] = ct[process] - at[process];
   wt[process] = tat[process] - bt[process];
   avg_tat+=tat[process];
   avg_wt+=wt[process];
   completed++;
}else{
 curr+=quantum;
 rt[process]-=quantum;
}
for(i=0;i<n;i++){
 if(!visited[i]&&at[i]<=curr&&rt[i]>0){
 q[rear]=i;
 rear++;
 visited[i]=0;
}
}
if(rt[process]>0){
 q[rear]=process;
 rear++;
}
}
if(front==rear){
 for(i=0;i<n;i++){
 if(rt[i]>0){
 curr = at[i];
q[rear]=i;
rear++;
visited[i]=1;
break;
}
}
}
  }

printf("\nProcess\tArrival Time\tBurst Time\tWaiting Time\tTurnaround Time\n");

    for (i = 0; i < n; i++) {
        avg_wt+= wt[i];
        avg_tat+= tat[i];
        printf("P%d\t%d\t\t%d\t\t%d\t\t%d\n", i + 1, at[i], bt[i], wt[i], tat[i]);
    }

    printf("\nAverage Waiting Time: %.2f\n", avg_wt / n);
    printf("Average Turnaround Time: %.2f\n", avg_tat / n);


    return 0;


}
